{% load static custom_filters %}
{% with pagina_actual=request.resolver_match.route %}
    <!-- INFORMACIÓN DE USUARIO -->
    <li class="nav-item user-info mb-2 mt-2">
        <div class="user-panel d-flex align-items-center p-3">
            <div class="user-avatar me-3">
                <div class="avatar-circle d-flex align-items-center justify-content-center bg-primary text-white rounded-circle"
                     style="width: 45px;
                            height: 45px;
                            font-size: 16px;
                            font-weight: 600">
                    {{ request.user.username|first|upper }}
                </div>
            </div>
            <div class="info flex-grow-1">
                <p class="mb-1 text-white fw-bold">{{ request.user.get_full_name|default:request.user.username }}</p>
                <p class="mb-0 text-white-50 small">
                    {% if request.user.groups.all %}
                        {{ request.user.groups.first.name }}
                    {% else %}
                        Sin grupo
                    {% endif %}
                </p>
            </div>
        </div>
    </li>
    
    <!-- INICIO -->
    <li class="nav-item nav-main-item">
        <a href="{% url 'inicio' %}"
           class="nav-link {% if 'inicio' in pagina_actual %}active{% endif %}">
            <img src="{% static 'custom/img/iconos_sidebar/inicio.svg' %}" alt="" />
            <p>Inicio</p>
        </a>
    </li>
    
    <!-- ADMINISTRACIÓN -->
    {% if request.user|has_group:"Administrador" %}
        <li class="nav-item nav-main-item">
            <a href="#" class="nav-link">
                <img src="{% static 'custom/img/iconos_sidebar/administracion.svg' %}" alt="" />
                <p>
                    Administración
                    <i class="nav-arrow bi bi-chevron-right"></i>
                </p>
            </a>
            <ul class="nav nav-treeview">
                <li class="nav-item">
                    <a href="{% url 'usuarios' %}"
                       class="nav-link nav-dot ms-2 {% if 'usuarios' in pagina_actual or 'password' in pagina_actual %}active{% endif %}">
                        <p>Usuarios</p>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="{% url 'grupos' %}"
                       class="nav-link nav-dot ms-2 {% if 'grupos' in pagina_actual %}active{% endif %}">
                        <p>Grupos</p>
                    </a>
                </li>
            </ul>
        </li>
    {% endif %}
    
    <!-- LEGAJOS -->
    <li class="nav-item nav-main-item {% if 'ciudadanos' in pagina_actual %}menu-open{% endif %}">
        <a href="#" class="nav-link">
            <img src="{% static 'custom/img/iconos_sidebar/legajos.svg' %}" alt="" />
            <p>
                Legajos
                <i class="nav-arrow bi bi-chevron-right"></i>
            </p>
        </a>
        <ul class="nav nav-treeview">
            <!-- CIUDADANOS -->
            {% if request.user|has_group:"Ciudadanos" %}
                <li class="nav-item {% if 'ciudadanos' in pagina_actual %}menu-open{% endif %}">
                    <a href="#"
                       class="nav-link nav-dot ms-2 {% if 'ciudadanos' in pagina_actual %}active{% endif %}">
                        <p>
                            Ciudadanos
                            <i class="nav-arrow bi bi-chevron-right"></i>
                        </p>
                    </a>
                    <ul class="nav nav-treeview">
                        <li class="nav-item">
                            <a href="{% url 'ciudadanos' %}"
                               class="nav-link ms-4 {% if 'ciudadanos/listar' in pagina_actual %}active{% endif %}">
                                <i class="nav-icon bi bi-arrow-return-right"></i>
                                <p>Búsqueda</p>
                            </a>
                        </li>
                    </ul>
                </li>
            {% endif %}
        </ul>
    </li>
{% endwith %}